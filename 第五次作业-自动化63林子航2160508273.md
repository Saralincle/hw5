# <center> 第五次作业  
### <center> 自动化63   
### <center> 林子航   
### <center> 2160508273   
### <center> 2019年3月30日  
## <center> 摘要  
&emsp;&emsp;本次实验实现了在频域对图像进行滤波，分别使用了巴特沃斯和高斯低通高通滤波器对test1和test2进行滤波，又在频域实现了拉普拉斯算子和非掩蔽提升和高提升滤波，并和Project4进行比较，分析频域和空域滤波各自的优缺点。  
&emsp;&emsp;实验一要求设计巴特沃斯和高斯低通滤波器来平滑测试图像test1和test2并分析各自的优缺点。同一幅图像通过相同截止频率的巴特沃斯低通滤波器和高斯低通器时，其功率谱比不会产生很大的差异，但随着巴特沃斯滤波器的阶数提高，滤波得到的图像产生的振铃现象将会越来越严重，而高斯滤波器不存在这个问题。  
&emsp;&emsp;实验二要求设计巴特沃斯和高斯高通滤波器来增强图像的边缘。高通滤波器的设计十分简单，只需用1减去对应的低通滤波器即可得到。与实验一一样，阶数较高的巴特沃斯高通滤波器同样会产生振铃效应，而高斯滤波器不会。  
&emsp;&emsp;实验三要求设计频域的拉普拉斯算子滤波器和unmask滤波器，对图像进行边缘提取。值得注意的是，拉普拉斯算子在频域的函数的值域并没有局限在[0,1]之间，因此会出现提取到的边缘的数量级远大于原图像的数量级。为解决这一问题需对拉普拉斯算子进行归一化。unmask滤波器实际上是一个图像增强的过程，采用高斯滤波器平滑图像后求差得到边缘，再进行高提升滤波，得到增强后的图像。    
&emsp;&emsp;最后我特别讨论了频域滤波和空域滤波的联系与不同之处。显然，频域滤波的算法复杂度更高，但带来的便利是通过修改截止频率就可以很方便地改变滤波结果，而不需要像空域滤波一样进行模板大小的选择；此外，频域滤波可能会出现振铃效果，这是我们不期望的。频域滤波的锐化效果要优于空域滤波，频域滤波还会出现比较明显的边界效应。  
&emsp;&emsp;通过本次实验，我对滤波器在图像处理中的作用更加了然于心，对频域和空域滤波的区别与联系也有了更深的体会。所有程序均为自己在研读算法之后独立编写完成的，虽然耗时巨大，但所获颇丰。  
## <center>实验一.频域低通滤波器  
### 一.技术讨论  
&emsp;&emsp;低通滤波器用于平滑图像，去噪，在生活中应用相当广泛，给出2种基本的低通滤波器：  
&emsp;&emsp;1.巴特沃斯低通滤波器：  
![](https://i.imgur.com/XM0aCCk.png)  
&emsp;&emsp;其中n表示阶数，D0表示截止频率。  
&emsp;&emsp;2.高斯低通滤波器：  
![](https://i.imgur.com/rR9Dyyf.png)  
&emsp;&emsp;其中D0表示截止频率，D(u,v)表示距离中心的距离，由下式给出：  
![](https://i.imgur.com/f1Nub5X.png)  
&emsp;&emsp;3.定义功率谱比：  
![](https://i.imgur.com/EH3m7e9.png)  
&emsp;&emsp;其中![](https://i.imgur.com/FKwpb1a.png)表示滤波后图像的功率谱总和，![](https://i.imgur.com/8Fq0RPW.png)表示原图像的功率谱总和。  
&emsp;&emsp;4.给出频域滤波的步骤：  
&emsp;&emsp;1)读取所有图像;  
&emsp;&emsp;2)编写滤波器的频域函数H(u,v)，BLPF代表巴特沃斯低通滤波器，GLPF代表高斯低通滤波器;  
&emsp;&emsp;3)对原图像f(x,y)进行补零操作。对大小为m×n的原图进行补零操作，补零后的图像大小为(2m)×(2n)；  
&emsp;&emsp;4)为了让图像的频谱移至中点位置，利用空域的移位性质，对补零后的图像乘以![](https://i.imgur.com/reeIvRp.png)；  
&emsp;&emsp;5)接着，对移位后的图像求取其二维傅里叶变换F(u,v)，并将低通滤波器的函数与求得的频谱相乘，得到滤波后图像的频谱G(u,v)；  
&emsp;&emsp;6)求取G(u,v)的逆傅里叶变换，得到滤波后的大小为2m×2n的图像g(x,y)；  
&emsp;&emsp;7)提取g(x,y)的左上角大小m×n的区域，得到最终滤波后的图像。  
&emsp;&emsp;整个过程通过自主编写的LPfilter函数完成，可通过选择滤波器类型（1表示巴特沃斯，2表示高斯滤波器）进行滤波器类型的选择。若选择巴特沃斯滤波器，可通过修改参数n的值来改变阶数。可通过修改d0的值修改截止频率。    
### 二.实验结果  
&emsp;&emsp;实验结果以教材上的展示形式给出，其中巴特沃斯低通滤波器使用的是阶数为1的滤波器。  
1.test1（d0=20,功率谱比p=51.22%，一阶巴特沃斯低通滤波器）  
![](https://i.imgur.com/oYyhmLa.jpg)  
2.test1（d0=20,功率谱比p=52.28%，高斯低通滤波器）  
![](https://i.imgur.com/1WXe4SP.jpg)  
3.test1（d0=100,功率谱比p=82.02%，一阶巴特沃斯低通滤波器）  
![](https://i.imgur.com/d4MIXtS.jpg)  
4.test1（d0=100,功率谱比p=84.65%，高斯低通滤波器）  
![](https://i.imgur.com/fkKccGs.jpg)  
5.test2（d0=20,功率谱比p=45.14%，一阶巴特沃斯低通滤波器）  
![](https://i.imgur.com/CY6ZcPW.jpg)  
6.test2（d0=20,功率谱比p=45.62%，高斯低通滤波器）  
![](https://i.imgur.com/QROe6IR.jpg)  
7.test2（d0=100,功率谱比p=68.93%，一阶巴特沃斯低通滤波器）  
![](https://i.imgur.com/7Ev48fK.jpg)  
8.test2（d0=100,功率谱比p=69.72%，高斯低通滤波器）  
![](https://i.imgur.com/NqQ9ZAQ.jpg)  
### 三.结果分析  
&emsp;&emsp;以上给出的实验结果显示的是一阶巴特沃斯低通滤波器和高斯低通滤波器的对比。不难发现一阶巴特沃斯低通滤波器和高斯低通滤波器差别不大，滤波的效果比较平缓，功率谱的比值由于两种滤波器在过渡带的差异会有细微的差异但基本相同。事实上，若增大巴特沃斯滤波器的阶数，则会产生较明显的振铃现象。给出截止频率为20的五阶巴特沃斯低通滤波器和截止频率为20的高斯低通滤波器进行比较：  
1.test1（d0=20,五阶巴特沃斯低通滤波器）  
![](https://i.imgur.com/67HzVaL.jpg)  
2.test1（d0=20,高斯低通滤波器）  
![](https://i.imgur.com/oXb600y.jpg)  
&emsp;&emsp;从第一幅图可以很明显地看出来产生了振铃效应，图像的边缘甚至都有些扭曲，而高斯低通滤波器的滤波效果不会产生振铃效应，它的时域和频域函数的形式是比较相近的。  
&emsp;&emsp;因此得出结论，高斯低通滤波器和一阶巴特沃斯低通滤波器的滤波效果近似，但随着阶数增高，巴特沃斯滤波器的滤波结果将会产生振铃效应，高斯滤波器则不受影响。  
## <center>实验二.频域高通滤波器  
### 一.技术讨论  
&emsp;&emsp;高通滤波器用于锐化图像，边缘提取等，其实现方式很简单，可以由低通滤波器直接得到：  
![](https://i.imgur.com/KIdxM7l.png)    
&emsp;&emsp;为了增强边缘显示的效果，在显示图像时设定大于0的点全为1，小于0点点全为0，得到强对比的边缘细节图像。  
&emsp;&emsp;在实现程序时，仅需要利用已有的低通滤波器函数BLPF和GLPF求得高通滤波器函数，功率谱比的定义与实验一一致。使用独立编写的HPfilter函数实现，修改type可以选择不同的高通滤波器，修改n可以改变高通巴特沃斯滤波器的阶数，修改d0可以改变截止频率。  
### 二.实验结果  
1.test3（d0=20,功率谱比p=31.11%，一阶巴特沃斯高通滤波器）  
![](https://i.imgur.com/uBVWS4l.jpg)  
2.test3（d0=20,功率谱比p=28.78%，高斯高通滤波器）  
![](https://i.imgur.com/c6BFYVQ.jpg)  
3.test3（d0=100,功率谱比p=6.53%，一阶巴特沃斯高通滤波器）  
![](https://i.imgur.com/jEqDImZ.jpg)  
4.test3（d0=100,功率谱比p=4.42%，高斯高通滤波器）  
![](https://i.imgur.com/jJfOpil.jpg)  
5.test4（d0=20,功率谱比p=47.36%，一阶巴特沃斯高通滤波器）  
![](https://i.imgur.com/nb5o9f3.jpg)  
6.test4（d0=20,功率谱比p=46.41%，高斯高通滤波器）  
![](https://i.imgur.com/R15V0lH.jpg)  
7.test4（d0=100,功率谱比p=22.35%，一阶巴特沃斯高通滤波器）  
![](https://i.imgur.com/RIQiKqC.jpg)  
8.test4（d0=100,功率谱比p=20.87%，高斯高通滤波器）  
![](https://i.imgur.com/JGoKSQL.jpg)  
### 三.结果分析  
&emsp;&emsp;从以上展示的实验结果可以发现，相同截止频率下，巴特沃斯高通滤波器得到的图像黑色部分较多，说明滤波后的负值较多，有些细节被漏掉了，整个图像的色调偏暗，而高斯高通滤波器对细节的提取更胜一筹，很多微小的细节都捕捉到了。  
&emsp;&emsp;同样，为了观察巴特沃斯高通滤波器在阶数较高时产生的振铃现象，给出截止频率为20的五阶巴特沃斯高通滤波器和截止频率为20的高斯高通滤波器进行比较：  
1.test1（d0=20,五阶巴特沃斯高通滤波器）  
![](https://i.imgur.com/fTBi7ny.jpg)  
2.test1（d0=20,高斯低通滤波器）  
![](https://i.imgur.com/VQ3352y.jpg)  
&emsp;&emsp;从第一幅图可以很明显地看出来产生了振铃效应，而高斯低通滤波器的滤波效果不会产生振铃效应，它的时域和频域函数的形式是比较相近的。  
&emsp;&emsp;因此得出结论，相同截止频率下，巴特沃斯高通滤波器的滤波效果没有高斯高通滤波器的效果好，且会产生振铃效应。  
## <center>实验三.频域拉普拉斯算子和unmask滤波  
### 一.技术讨论  
&emsp;&emsp;拉普拉斯算子和unmask都是边缘提取的基本算法。本次实验要求在频域实现这两种算法。  
&emsp;&emsp;1.拉普拉斯算子  
&emsp;&emsp;可以证明，拉普拉斯算子在频域可用如下表达式实现：  
![](https://i.imgur.com/UyZruhk.png)  
![](https://i.imgur.com/ek1lcuX.png)  
&emsp;&emsp;其中D(u,v)和实验一中的定义一致。使用拉普拉斯算子进行边缘提取得到的图像为：  
![](https://i.imgur.com/XFnZPn8.png)  
&emsp;&emsp;其中c=-1。在空域，实现拉普拉斯算子的方法是直接将mask与图像卷积，由于mask的和为0，不存在系数不匹配的问题。而在频域上，显然上式给出的H(u,v)的值域不在[0,1]内，这样就有可能出现由于引入了DFT系数使得滤波后的图像与原图像不在一个数量级上的问题。为解决这一问题，需要对f(x,y)和拉普拉斯算子均进行归一化。步骤如下：    
&emsp;&emsp;（1）计算H(u,v)；  
&emsp;&emsp;（2）计算拉普拉斯算子，由于其存在负值，因此为将其归一化至[-1,1]，需要用拉普拉斯算子除以其绝对值的最大值，完成归一化；  
&emsp;&emsp;（3）将f(x,y)归一化至[0,1]区间；  
&emsp;&emsp;（4）求和得到g(x,y)，得到滤波后图像。  
&emsp;&emsp;由于要进行归一化，我单独编写了拉普拉斯算子的滤波函数，由LAPfilter函数实现。  
&emsp;&emsp;2.unmask滤波  
&emsp;&emsp;unmask滤波是在用低通滤波器平滑处理图像后，得到mask，再与原图像f(x,y)进行线性组合得到的。表达如下：  
![](https://i.imgur.com/xl4EjON.png)  
&emsp;&emsp;本次实验中，unmask滤波选取的低通滤波器为高斯低通滤波器，且整合在HPfilter函数中，修改type=3即可使用。  
### 二.实验结果  
&emsp;&emsp;1.test3(using unsharp masking,d0=20):  
![](https://i.imgur.com/Fs0T5eN.jpg)  
&emsp;&emsp;2.test3(using unsharp masking,d0=100):  
![](https://i.imgur.com/Y0kGBZp.jpg)  
&emsp;&emsp;3.test3(using laplace):  
![](https://i.imgur.com/nTn87k3.jpg)  
&emsp;&emsp;1.test4(using unsharp masking,d0=20):  
![](https://i.imgur.com/eZpzz0q.jpg)  
&emsp;&emsp;2.test4(using unsharp masking,d0=100):  
![](https://i.imgur.com/0hJuhTq.jpg)  
&emsp;&emsp;3.test4(using laplace):  
![](https://i.imgur.com/Vttxpet.jpg)  
### 三.结果分析  
&emsp;&emsp;从结果不难看出，unmask的细节提取效果优于拉普拉斯算子，unmask在test3中将黑方块里的不易察觉的细节都提取出来了，但laplace只能提取出一个大致的轮廓，提取的边缘不明显。    
## <center>对比频域滤波和空域滤波   
&emsp;&emsp;1.低通滤波器  
&emsp;&emsp;给出使用3×3大小的高斯滤波器模板在空域滤波得到的结果以及在频域使用高斯滤波器得到的结果进行比较：  
&emsp;&emsp;1)3×3大小的高斯滤波模板空域滤波结果：  
![](https://i.imgur.com/IRikVi7.jpg)  
&emsp;&emsp;2)高斯低通滤波器频域滤波结果，截止频率为100：  
![](https://i.imgur.com/RgvSvHD.jpg)  
&emsp;&emsp;频域滤波的算法复杂度更高，但带来的便利是通过修改截止频率就可以很方便地改变滤波结果，而不需要像空域滤波一样进行模板大小的选择。整体看来，频域滤波的效果和空域滤波没有太大的差异，但仔细观察可以发现，频域滤波得到的图像存在一种“边界效应”，即在图像周围存在很细的一个黑色边界，而空域滤波不存在这个问题。此外，若使用巴特沃斯滤波器，在阶数较高的情况下还可能会出现振铃效应。   
&emsp;&emsp;2.高通滤波器  
&emsp;&emsp;给出系数为5的unmask高通滤波器空域滤波得到的结果以及在频域使用unmask滤波器得到的结果进行比较：  
&emsp;&emsp;1)k=5的unmask空域滤波结果：  
![](https://i.imgur.com/XaBBKAn.jpg)  
&emsp;&emsp;2)截止频率为100的基于高斯低通滤波器的unmask滤波：  
![](https://i.imgur.com/vlB0c8i.jpg)  
&emsp;&emsp;可以看到频域的锐化效果更佳，棱角更佳分明，原因可能是频域滤波对边缘的提取是基于频率的，抓住的是边缘的最突出的特征，即高频率，因此高通滤波得到的效果更好，对边缘和细节的选取优于空域滤波。   
## <center>实验感想  
&emsp;&emsp;本次实验实现了图像的高通、低通滤波，并接触了频域滤波在图像处理中的作用，加深了我对频域滤波在图像处理中的应用的理解。低通滤波主要的应用是去噪，而不同的滤波器又针对不同的噪声；高通滤波器则主要用于边缘提取。通过本次实验，我对频域滤波和空域滤波的区别与联系有了进一步的了解。所有程序均为自己在研读算法之后独立编写完成的，虽然耗时巨大，但所获颇丰。。  